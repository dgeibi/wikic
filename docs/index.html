<!doctype html>
<html>
  <head>
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta charset="UTF-8">
      <title>Wikic</title>
    <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/github.css">
  </head>
  <body>
    <div class="wrapper">
        <h1>Wikic</h1>
<p><a href="https://travis-ci.org/wikic/wikic"><img src="https://travis-ci.org/wikic/wikic.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/github/wikic/wikic"><img src="https://img.shields.io/coveralls/wikic/wikic.svg" alt="Coveralls"></a>
<a href="https://github.com/wikic/wikic/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="MIT License"></a>
<a href="https://www.npmjs.com/package/wikic"><img src="https://img.shields.io/npm/v/wikic.svg" alt="version"></a>
<a href="https://nodejs.org"><img src="https://img.shields.io/badge/node-%3E%3D%207.0.0-brightgreen.svg" alt="Node"></a></p>
<p>a simple static site generator</p>
<h2 id="table-of-contents">Table of Contents<a class="anchor" href="#table-of-contents"></a></h2>
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#cli">CLI</a></li>
<li><a href="#node-module">Node module</a></li>
</ul>
</li>
<li><a href="#getting-started">Getting started</a>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration-and-front-matter">Configuration and Front Matter</a></li>
<li><a href="#layouts">Layouts</a></li>
<li><a href="#plugins">Plugins</a></li>
<li><a href="#tasks">Tasks</a></li>
<li><a href="#suites">Suites</a></li>
</ul>
</li>
<li><a href="#api">API</a>
<ul>
<li><a href="#wikiccwd-config">Wikic([cwd, [config]])</a></li>
<li><a href="#wikicsetupcwd-config">wikic.setup([cwd, [config]])</a></li>
<li><a href="#wikicclean">wikic.clean()</a></li>
<li><a href="#wikicbuild">wikic.build()</a></li>
<li><a href="#wikicaddpluginkey-plugin">wikic.addPlugin(key, plugin)</a></li>
<li><a href="#wikicaddtaskkey-task">wikic.addTask(key, task)</a></li>
<li><a href="#wikicaddsuitesuite">wikic.addSuite(suite)</a></li>
<li><a href="#wikicwatch">wikic.watch()</a></li>
<li><a href="#wikicserve">wikic.serve()</a></li>
<li><a href="#wikictypemapkey">wikic.typeMap(key)</a></li>
<li><a href="#wikicgeturlurl">wikic.getURL(url)</a></li>
<li><a href="#wikicfse">wikic.fse</a></li>
<li><a href="#wikicconfig">wikic.config</a></li>
<li><a href="#wikicrenderer">wikic.renderer</a></li>
</ul>
</li>
<li><a href="#thanks">Thanks</a></li>
<li><a href="#license">LICENSE</a></li>
</ul>
<h2 id="example">Example<a class="anchor" href="#example"></a></h2>
<ul>
<li><a href="https://github.com/dgeibi/note">dgeibi/note</a></li>
</ul>
<h2 id="usage">Usage<a class="anchor" href="#usage"></a></h2>
<h3 id="cli">CLI<a class="anchor" href="#cli"></a></h3>
<h4 id="wikic-init"><code>wikic init</code><a class="anchor" href="#wikic-init"></a></h4>
<p>Use <code>wikic init</code> to create a new wikic folder</p>
<pre class="hljs"><code>wikic init &lt;dir&gt;
</code></pre>
<h4 id="wikic-build"><code>wikic build</code><a class="anchor" href="#wikic-build"></a></h4>
<p>Use <code>wikic build</code> to build pages.</p>
<pre class="hljs"><code>wikic build [options]
<span class="hljs-comment">#  Options:</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment">#    -h, --help           output usage information</span>
<span class="hljs-comment">#    -c, --clean          clean public dir before building</span>
<span class="hljs-comment">#    -w, --watch          watch src dir change</span>
<span class="hljs-comment">#    -s, --serve          serve public dir</span>
<span class="hljs-comment">#    -d, --dir &lt;dir&gt;      change working dir</span>
<span class="hljs-comment">#    -o, --output &lt;dir&gt;   change public dir</span>
<span class="hljs-comment">#    -p, --port &lt;number&gt;  change server port</span>
</code></pre>
<h3 id="node-module">Node module<a class="anchor" href="#node-module"></a></h3>
<pre class="hljs"><code><span class="hljs-keyword">const</span> htmlclean = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;htmlclean&apos;</span>);
<span class="hljs-keyword">const</span> Wikic = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;wikic&apos;</span>);
<span class="hljs-keyword">const</span> docslist = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;wikic-suite-docslist&apos;</span>);

<span class="hljs-keyword">const</span> wikic = <span class="hljs-keyword">new</span> Wikic();

<span class="hljs-comment">// add plugin to minify html before write</span>
wikic.addPlugin(<span class="hljs-string">&apos;beforeWrite&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">minify</span>(<span class="hljs-params">context</span>) </span>{
  <span class="hljs-keyword">if</span> (!context.data) <span class="hljs-keyword">return</span> context;
  <span class="hljs-keyword">const</span> html = htmlclean(context.data);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, context, { <span class="hljs-attr">data</span>: html });
});

<span class="hljs-comment">// add suite to provide `list` variable</span>
wikic.addSuite(docslist);

<span class="hljs-comment">// build the site and start watcher and server to debug or preview</span>
wikic
  .build()
  .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> wikic.watch())
  .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> wikic.serve());
</code></pre>
<h2 id="getting-started">Getting started<a class="anchor" href="#getting-started"></a></h2>
<h3 id="installation">Installation<a class="anchor" href="#installation"></a></h3>
<pre class="hljs"><code><span class="hljs-comment"># install as a cli tool</span>
npm install -g wikic

<span class="hljs-comment"># install as a node dependency</span>
npm install --save wikic
</code></pre>
<h3 id="configuration-and-front-matter">Configuration and Front Matter<a class="anchor" href="#configuration-and-front-matter"></a></h3>
<p>Default Config: <a href="https://github.com/wikic/wikic/blob/master/lib/defaultConfig.yml">lib/defaultConfig.yml</a></p>
<p>You can create <code>_config.yml</code>s or a <code>wikic.config.js</code> to override defaultConfig.</p>
<p>Here are inheritance chains of configuration:</p>
<ul>
<li><a href="https://github.com/wikic/wikic/blob/master/lib/defaultConfig.yml">lib/defaultConfig.yml</a>, <code>_config.yml</code> and <code>wikic.config.js</code> (in <code>wikic.cwd</code>) =&gt; <code>wikic.config</code></li>
<li><code>wikic.config</code>, <code>_config.yml</code> (subdirectory of <code>wikic.cwd</code>, closest to markdown file) =&gt; <code>context.site</code></li>
<li><code>context.page</code>, <code>context.site.page</code>, Front Matter in markdown =&gt; <code>context.page</code></li>
</ul>
<p>The <code>_config.yml</code> and <code>wikic.config.js</code> in <code>wikic.cwd</code> will be loaded as <code>wikic.config</code>.</p>
<p>The <code>_config.yml</code> closest to markdown will be merged into <code>context.site</code> (global config which is passed to plugins).</p>
<p>Front Matter in each markdown will be merged into <code>context.page</code> (page config which is passed to plugins) respectively.</p>
<p><strong>Note</strong>: In <code>wikic.cwd</code>, <code>wikic.config.js</code> &gt; <code>_config.yml</code></p>
<p><strong><code>wikic.config.js</code> Example</strong>:</p>
<pre class="hljs"><code><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">title</span>: <span class="hljs-string">&apos;Wikic&apos;</span>,
  <span class="hljs-attr">toc</span>: {
    <span class="hljs-attr">selectors</span>: <span class="hljs-string">&apos;h2, h3, h4&apos;</span>,
  },
};
</code></pre>
<p><strong>Front Matter example</strong>:</p>
<pre class="hljs"><code><span class="hljs-meta">---</span>
<span class="hljs-attr">title:</span> <span class="hljs-string">Hello</span> <span class="hljs-string">World</span> <span class="hljs-comment"># title of the page</span>
<span class="hljs-attr">toc:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># disable toc for this page</span>
<span class="hljs-attr">layout:</span> <span class="hljs-string">docs</span> <span class="hljs-comment"># set layout for this page</span>
<span class="hljs-meta">---</span>
</code></pre>
<h3 id="layouts">Layouts<a class="anchor" href="#layouts"></a></h3>
<p>You can create <a href="https://mozilla.github.io/nunjucks/templating.html">Nunjucks</a> templates (extname is <code>.njk</code>) in <code>layoutPath</code>.</p>
<p>In order to specify default layout for markdowns in a specific path, create a <code>_config.yml</code> in the path and add lines to it:</p>
<pre class="hljs"><code><span class="hljs-attr">page:</span>
<span class="hljs-attr">  layout:</span> <span class="hljs-string">customLayout</span>
</code></pre>
<p>Also, you can set <code>layout</code> in Front Matter for a specific markdown.</p>
<h4 id="variables-in-layouts">Variables in Layouts<a class="anchor" href="#variables-in-layouts"></a></h4>
<ul>
<li><code>site</code>, <code>Object</code>, reference to <code>context.site</code></li>
<li><code>page</code>, <code>Object</code>, reference to <code>context.page</code>
<ul>
<li><code>page.types</code>, <code>Array</code>, markdown&apos;s dirnames</li>
</ul>
</li>
<li><code>content</code>, string, content of HTML built from markdown</li>
</ul>
<h4 id="builtin-filters">Builtin Filters<a class="anchor" href="#builtin-filters"></a></h4>
<ul>
<li><code>typeMap</code>: see <a href="#wikictypemapkey"><code>wikic.typeMap(key)</code></a></li>
<li><code>baseurl</code>: see <a href="#wikicgeturlurl"><code>wikic.getURL(url)</code></a></li>
<li><code>relative</code>: Receives a absolute path string, returns a url relative to current page.</li>
<li><code>typeMaps</code>: Receives a <code>Array</code>, Returns <code>array.map(typeMap)</code>. Tips: get typeNames array <code>{{ page.types | typeMaps }}</code></li>
</ul>
<h4 id="nunjucks-in-markdown">Nunjucks in Markdown<a class="anchor" href="#nunjucks-in-markdown"></a></h4>
<p>Variable <code>site</code> and <code>page</code> is available.</p>
<p><code>{{</code>, <code>}}</code>, <code>{#</code>, <code>#}</code>, <code>{%</code>, <code>%}</code> in raw blocks and <code>&lt;code&gt;</code> blocks will be escaped.</p>
<pre class="hljs"><code><span class="hljs-comment">&lt;!-- markdown --&gt;</span>
{% raw %}
{{ page.title }}
{% endraw %}

<span class="hljs-comment">&lt;!-- output --&gt;</span>
{{ page.title }}
</code></pre>
<pre class="hljs"><code><span class="hljs-comment">&lt;!-- markdown --&gt;</span>
`{{ page.title }}`

<span class="hljs-comment">&lt;!-- output --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>{{ page.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
</code></pre>
<h3 id="plugins">Plugins<a class="anchor" href="#plugins"></a></h3>
<p>A &apos;plugin&apos; is a <code>Function</code>, which receives a <code>context</code> and returns a <code>context</code>. If a plugin is invoked, <code>this</code> in it may point to <code>wikic</code>. The context returned by a plugin will be passed to next plugin.</p>
<p><strong>context</strong></p>
<p>The <code>context</code> passed to a plugin is an <code>Object</code> which contains some of the following properties:</p>
<ul>
<li><code>src</code>: string, absolute path of source</li>
<li><code>dist</code>: string, absolute path of destination</li>
<li><code>data</code>: string, content of document</li>
<li><code>site</code>: <code>Object</code>, site config</li>
<li><code>page</code>: <code>Object</code>, page config</li>
<li><code>renderContext</code>: <code>Object</code>, nunjucks render context, contains <a href="#variables-in-layouts">variables</a></li>
<li><code>IS_DOC</code>: boolean, whether in <code>docsPath</code></li>
</ul>
<p><strong>Types of plugin</strong></p>
<p>Different types of plugin will invoked in different periods.</p>
<ul>
<li><code>afterRead</code>: invoked after reading each markdown file.</li>
<li><code>beforeWrite</code>: invoked before writing each markdown file.</li>
<li><code>beforeRender</code>: invoked before rendering each markdown file.</li>
</ul>
<p><strong>Example</strong></p>
<p>In <code>wikic.config.js</code></p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> htmlclean = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;htmlclean&apos;</span>);

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">beforeWritePlugins</span>: [
    <span class="hljs-function">(<span class="hljs-params">context</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!context.data) <span class="hljs-keyword">return</span> context;
        <span class="hljs-keyword">const</span> html = htmlclean(context.data);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, context, { <span class="hljs-attr">data</span>: html });
    },
  ]
};
</code></pre>
<p>You can also use <a href="#wikicaddpluginkey-plugin"><code>wikic.addPlugin</code></a> to add plugins.</p>
<h3 id="tasks">Tasks<a class="anchor" href="#tasks"></a></h3>
<p>Unlike plugins, &apos;tasks&apos; are <code>Function</code> without context.</p>
<p><strong>Types of task</strong></p>
<p>Different types of task will invoked in different periods.</p>
<ul>
<li><code>afterReadAllDocs</code>: after reading all docs, before writing all docs.</li>
<li><code>beforeBuild</code>: before building all things.</li>
<li><code>beforeBuildDocs</code>: before building all docs.</li>
<li><code>afterBuild</code>: after building all things.</li>
<li><code>afterBuildDocs</code>: after building all docs.</li>
</ul>
<p><strong>Example</strong></p>
<p>In <code>wikic.config.js</code></p>
<pre class="hljs"><code><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">beforeBuildTasks</span>: [
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.time(<span class="hljs-string">&apos;build&apos;</span>);
    }
  ],
  <span class="hljs-attr">afterBuildTasks</span>: [
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">&apos;build&apos;</span>);
    }
  ],
};
</code></pre>
<p>You can also use <a href="#wikicaddtaskkey-task"><code>wikic.addTask</code></a> to add tasks.</p>
<h3 id="suites">Suites<a class="anchor" href="#suites"></a></h3>
<p>A &apos;suite&apos; should be a combination of <code>plugins</code> and <code>tasks</code>. It should be a plain <code>Object</code> or a <code>Function</code> which receives <code>config</code> and returns an <code>Object</code> or a falsy value.</p>
<p><strong>Properties</strong></p>
<p>There are two kinds of property in suite.</p>
<ul>
<li>Tasks:
<ul>
<li><code>afterReadAllDocs</code></li>
<li><code>beforeBuild</code></li>
<li><code>beforeBuildDocs</code></li>
<li><code>afterBuild</code></li>
<li><code>afterBuildDocs</code></li>
</ul>
</li>
<li>Plugins:
<ul>
<li><code>afterRead</code></li>
<li><code>beforeWrite</code></li>
<li><code>beforeRender</code></li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>In <code>wikic.config.js</code></p>
<pre class="hljs"><code><span class="hljs-comment">// use an `Object` directly</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">suites</span>: [
    {
      <span class="hljs-attr">beforeBuild</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.time(<span class="hljs-string">&apos;build&apos;</span>);
      },
      <span class="hljs-attr">afterBuild</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">&apos;build&apos;</span>);
      }
    }
  ],
};

<span class="hljs-comment">// or use a `Function`</span>
<span class="hljs-keyword">const</span> showBuildTime = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) </span>{
  <span class="hljs-comment">// if option `time` is falsy, do not add suite</span>
  <span class="hljs-keyword">if</span> (!config.time) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">beforeBuild</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.time(<span class="hljs-string">&apos;build&apos;</span>);
    },
    <span class="hljs-attr">afterBuild</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">&apos;build&apos;</span>);
    }
  };
}

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">suites</span>: [showBuildTime],
};
</code></pre>
<p>You can also use <a href="#wikicaddsuitesuite"><code>wikic.addSuite</code></a> to add suites.</p>
<h2 id="api">API<a class="anchor" href="#api"></a></h2>
<h3 id="wikiccwd-config">Wikic([cwd, [config]])<a class="anchor" href="#wikiccwd-config"></a></h3>
<ul>
<li><code>cwd</code>: string, working dir, default value is <code>process.cwd()</code></li>
<li><code>config</code>: <code>Object</code>, overwrite config loaded from <code>cwd</code>&apos;s <code>_config.yml</code> and <code>wikic.config.js</code></li>
</ul>
<p>Create a <code>Wikic</code>. Set working directory to <code>path/to</code> and set server&apos;s port to <code>1234</code>:</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> wikic = <span class="hljs-keyword">new</span> Wikic(<span class="hljs-string">&apos;path/to&apos;</span>, { <span class="hljs-attr">port</span>: <span class="hljs-number">1234</span> });
</code></pre>
<h3 id="wikicsetupcwd-config">wikic.setup([cwd, [config]])<a class="anchor" href="#wikicsetupcwd-config"></a></h3>
<ul>
<li><code>cwd</code>: string, working dir, default value is <code>process.cwd()</code></li>
<li><code>config</code>: <code>Object</code>, overwrite content of <code>cwd</code>&apos;s <code>_config.yml</code> and <code>wikic.config.js</code></li>
<li>Returns: <code>this</code></li>
</ul>
<p>Reloads configurations and layouts.</p>
<h3 id="wikicclean">wikic.clean()<a class="anchor" href="#wikicclean"></a></h3>
<ul>
<li>Returns a <code>Promise</code></li>
</ul>
<p>Cleans all the files in <code>publicPath</code></p>
<h3 id="wikicbuild">wikic.build()<a class="anchor" href="#wikicbuild"></a></h3>
<ul>
<li>Returns a <code>Promise</code></li>
</ul>
<p>Builds all the files in <code>docsPath</code> and <code>root</code></p>
<h3 id="wikicaddpluginkey-plugin">wikic.addPlugin(key, plugin)<a class="anchor" href="#wikicaddpluginkey-plugin"></a></h3>
<ul>
<li><code>key</code>: string, type of plugin</li>
<li><code>plugin</code>: <code>Function</code></li>
<li>Returns <code>this</code></li>
</ul>
<p>See also <a href="#plugins">Plugins</a></p>
<h3 id="wikicaddtaskkey-task">wikic.addTask(key, task)<a class="anchor" href="#wikicaddtaskkey-task"></a></h3>
<ul>
<li><code>key</code>: string, type of task</li>
<li><code>task</code>: <code>Function</code></li>
<li>Returns <code>this</code></li>
</ul>
<p>See also <a href="#tasks">Tasks</a></p>
<h3 id="wikicaddsuitesuite">wikic.addSuite(suite)<a class="anchor" href="#wikicaddsuitesuite"></a></h3>
<ul>
<li><code>suite</code>: <code>Object</code> | <code>Function</code></li>
<li>Returns <code>this</code></li>
</ul>
<p>See also <a href="#suites">Suites</a></p>
<h3 id="wikicwatch">wikic.watch()<a class="anchor" href="#wikicwatch"></a></h3>
<ul>
<li>Returns <code>this</code></li>
</ul>
<p>Watches file change and run <code>wikic.build()</code> when changed</p>
<h3 id="wikicserve">wikic.serve()<a class="anchor" href="#wikicserve"></a></h3>
<ul>
<li>Returns a <code>Promise</code></li>
</ul>
<p>Serves the files in <code>PublicPath</code></p>
<h3 id="wikictypemapkey">wikic.typeMap(key)<a class="anchor" href="#wikictypemapkey"></a></h3>
<ul>
<li><code>key</code>: string</li>
<li>Returns typeName(a string) set in <code>wikic.config.typeMap</code></li>
</ul>
<h3 id="wikicgeturlurl">wikic.getURL(url)<a class="anchor" href="#wikicgeturlurl"></a></h3>
<ul>
<li><code>url</code>: string</li>
<li>Returns an absolute URL prefixed with base URL</li>
</ul>
<h3 id="wikicfse">wikic.fse<a class="anchor" href="#wikicfse"></a></h3>
<p>A shortcut for <a href="https://github.com/jprichardson/node-fs-extra">jprichardson/node-fs-extra</a></p>
<h3 id="wikicconfig">wikic.config<a class="anchor" href="#wikicconfig"></a></h3>
<p>User configuration</p>
<p>See also <a href="#configuration-and-front-matter">Configuration and Front Matter</a></p>
<h3 id="wikicrenderer">wikic.renderer<a class="anchor" href="#wikicrenderer"></a></h3>
<p>Nunjucks renderer</p>
<p>For usage, see <a href="https://mozilla.github.io/nunjucks/api.html">Nunjucks</a></p>
<h2 id="thanks">Thanks<a class="anchor" href="#thanks"></a></h2>
<ul>
<li><a href="https://github.com/xcatliu/pagic">xcatliu/pagic</a></li>
<li><a href="https://github.com/jonschlinkert/html-toc">jonschlinkert/html-toc</a></li>
<li><a href="http://adrianmejia.com/blog/2016/08/24/Building-a-Node-js-static-file-server-files-over-HTTP-using-ES6/">Adrian Mejia Blog</a></li>
<li>...</li>
</ul>
<h2 id="license">LICENSE<a class="anchor" href="#license"></a></h2>
<p><a href="https://github.com/wikic/wikic/blob/master/LICENSE">MIT</a></p>

        </div>
  </body>
</html>
