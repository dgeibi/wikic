<!doctype html>
<html>
  <head>
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta charset="UTF-8">
      <title>Wikic</title>
    <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/github.css">
  </head>
  <body>
    <div class="wrapper">
        <h1>Wikic</h1>
<p><a href="https://travis-ci.org/dgeibi/wikic"><img src="https://travis-ci.org/dgeibi/wikic.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/github/dgeibi/wikic"><img src="https://img.shields.io/coveralls/dgeibi/wikic.svg" alt="Coveralls"></a>
<a href="LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="MIT License"></a>
<a href="https://www.npmjs.com/package/wikic"><img src="https://img.shields.io/npm/v/wikic.svg" alt="version"></a>
<a href="https://nodejs.org"><img src="https://img.shields.io/badge/node-%3E%3D%207.0.0-brightgreen.svg" alt="Node"></a></p>
<p>a simple static site generator</p>
<h2 id="table-of-contents">Table of Contents<a class="anchor" href="#table-of-contents"></a></h2>
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#cli">CLI</a></li>
<li><a href="#node-module">Node module</a></li>
</ul>
</li>
<li><a href="#getting-started">Getting started</a>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration-and-front-matter">Configuration and Front Matter</a></li>
<li><a href="#layouts">Layouts</a></li>
<li><a href="#plugins">Plugins</a></li>
</ul>
</li>
<li><a href="#api">API</a>
<ul>
<li><a href="#wikiccwd">Wikic([cwd])</a></li>
<li><a href="#wikicsetupcwd">wikic.setup([cwd])</a></li>
<li><a href="#wikicclean">wikic.clean()</a></li>
<li><a href="#wikicbuild">wikic.build()</a></li>
<li><a href="#wikicaddpluginkey-plugin">wikic.addPlugin(key, plugin)</a></li>
<li><a href="#wikicwatch">wikic.watch()</a></li>
<li><a href="#wikicserve">wikic.serve()</a></li>
<li><a href="#wikictypemapkey">wikic.typeMap(key)</a></li>
<li><a href="#wikicgeturlurl">wikic.getURL(url)</a></li>
<li><a href="#wikicsetlisttemplateopts">wikic.setListTemplate(opts)</a></li>
</ul>
</li>
<li><a href="#thanks">Thanks</a></li>
<li><a href="#license">LICENSE</a></li>
</ul>
<h2 id="example">Example<a class="anchor" href="#example"></a></h2>
<ul>
<li><a href="https://github.com/dgeibi/note">dgeibi/note</a></li>
</ul>
<h2 id="usage">Usage<a class="anchor" href="#usage"></a></h2>
<h3 id="cli">CLI<a class="anchor" href="#cli"></a></h3>
<h4 id="wikic-init"><code>wikic init</code><a class="anchor" href="#wikic-init"></a></h4>
<p>Use <code>wikic init</code> to create a new wikic folder</p>
<pre class="hljs"><code>wikic init &lt;dir&gt;
</code></pre>
<h4 id="wikic-build"><code>wikic build</code><a class="anchor" href="#wikic-build"></a></h4>
<p>Use <code>wikic build</code> to build pages.</p>
<pre class="hljs"><code>wikic build [options]
<span class="hljs-comment">#  Options:</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment">#    -h, --help       output usage information</span>
<span class="hljs-comment">#    -c, --clean      clean public dir before building</span>
<span class="hljs-comment">#    -w, --watch      watch src dir change</span>
<span class="hljs-comment">#    -s, --serve      serve public dir</span>
<span class="hljs-comment">#    -d, --dir &lt;dir&gt;  change working dir</span>
</code></pre>
<h3 id="node-module">Node module<a class="anchor" href="#node-module"></a></h3>
<pre class="hljs"><code><span class="hljs-keyword">const</span> htmlclean = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;htmlclean&apos;</span>);
<span class="hljs-keyword">const</span> Wikic = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;wikic&apos;</span>);

<span class="hljs-keyword">const</span> wikic = <span class="hljs-keyword">new</span> Wikic();

<span class="hljs-comment">// add plugin to minify html before write</span>
wikic.addPlugin(<span class="hljs-string">&apos;beforeWrite&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">minify</span>(<span class="hljs-params">context</span>) </span>{
  <span class="hljs-keyword">if</span> (!context.data) <span class="hljs-keyword">return</span> context;
  <span class="hljs-keyword">const</span> html = htmlclean(context.data);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, context, { <span class="hljs-attr">data</span>: html });
});

<span class="hljs-comment">// build the site and start watcher and server to debug or preview</span>
wikic
  .build()
  .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> wikic.watch())
  .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> wikic.serve());
</code></pre>
<h2 id="getting-started">Getting started<a class="anchor" href="#getting-started"></a></h2>
<h3 id="installation">Installation<a class="anchor" href="#installation"></a></h3>
<pre class="hljs"><code><span class="hljs-comment"># install as a cli tool</span>
npm install -g wikic

<span class="hljs-comment"># install as a node dependency</span>
npm install --save wikic
</code></pre>
<h3 id="configuration-and-front-matter">Configuration and Front Matter<a class="anchor" href="#configuration-and-front-matter"></a></h3>
<p>Default Config: <a href="lib/defaultConfig.yml">lib/defaultConfig.yml</a></p>
<p>You can create <code>_config.yml</code>s to override defaultConfig.</p>
<p>Here are inheritance chains of configuration:</p>
<ul>
<li><a href="lib/defaultConfig.yml">lib/defaultConfig.yml</a>,  <code>_config.yml</code> (in <code>wikic.cwd</code>) =&gt; <code>wikic.config</code></li>
<li><code>wikic.config</code>, <code>_config.yml</code> (subdirectory of <code>wikic.cwd</code>, closest to markdown file) =&gt; <code>context.site</code></li>
<li><code>context.page</code>, <code>context.site.page</code>, Front Matter in markdown =&gt; <code>context.page</code></li>
</ul>
<p>The <code>_config.yml</code> in <code>wikic.cwd</code> will be loaded as <code>wikic.config</code>.</p>
<p>The <code>_config.yml</code> closest to markdown will be merged into <code>context.site</code> (global config which is passed to plugins).</p>
<p>Front Matter in each markdown will be merged into <code>context.page</code> (page config which is passed to plugins) respectively.</p>
<p>Front Matter example:</p>
<pre class="hljs"><code><span class="hljs-meta">---</span>
<span class="hljs-attr">title:</span> <span class="hljs-string">Hello</span> <span class="hljs-string">World</span> <span class="hljs-comment"># title of the page</span>
<span class="hljs-attr">toc:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># disable toc for this page</span>
<span class="hljs-attr">layout:</span> <span class="hljs-string">docs</span> <span class="hljs-comment"># set layout for this page</span>
<span class="hljs-attr">hide:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># hide this page from docs list(necessary for the file in docsPath)</span>
<span class="hljs-meta">---</span>
</code></pre>
<h3 id="layouts">Layouts<a class="anchor" href="#layouts"></a></h3>
<p>You can create <a href="https://mozilla.github.io/nunjucks/templating.html">Nunjucks</a> templates (extname is <code>.njk</code>) in <code>layoutPath</code>.</p>
<p>In order to specify default layout for markdowns in a specific path, create a <code>_config.yml</code> in the path and add lines to it:</p>
<pre class="hljs"><code><span class="hljs-attr">page:</span>
<span class="hljs-attr">  layout:</span> <span class="hljs-string">customLayout</span>
</code></pre>
<p>Also, you can set <code>layout</code> in Front Matter for a specific markdown.</p>
<h4 id="variables-in-layouts">Variables in Layouts<a class="anchor" href="#variables-in-layouts"></a></h4>
<ul>
<li><code>site</code>, <code>Object</code>, reference to <code>context.site</code></li>
<li><code>page</code>, <code>Object</code>, reference to <code>context.page</code>
<ul>
<li><code>page.types</code>, <code>Array</code>, markdown&apos;s dirnames</li>
</ul>
</li>
<li><code>content</code>, string, content of HTML built from markdown</li>
</ul>
<p>For markdowns in <code>docsPath</code></p>
<ul>
<li><code>list</code>, string, list of documents in <code>docsPath</code>, See also <a href="#wikicsetlisttemplateopts"><code>wikic.setListTemplate(opts)</code></a></li>
</ul>
<h4 id="builtin-filters">Builtin Filters<a class="anchor" href="#builtin-filters"></a></h4>
<ul>
<li><code>typeMap</code>: see <a href="#wikictypemapkey"><code>wikic.typeMap(key)</code></a></li>
<li><code>baseurl</code>: see <a href="#wikicgeturlurl"><code>wikic.getURL(url)</code></a></li>
<li><code>relative</code>: Receives a absolute path string, returns a url relative to current page.</li>
<li><code>typeMaps</code>: Receives a <code>Array</code>, Returns <code>array.map(typeMap)</code>. Tips: get typeNames array <code>{{ page.types | typeMaps }}</code></li>
</ul>
<h4 id="nunjucks-in-markdown">Nunjucks in Markdown<a class="anchor" href="#nunjucks-in-markdown"></a></h4>
<p>Variable <code>site</code> and <code>page</code> is available.</p>
<p><code>{{</code>, <code>}}</code>, <code>{#</code>, <code>#}</code>, <code>{%</code>, <code>%}</code> in raw blocks and <code>&lt;code&gt;</code> blocks will be escaped.</p>
<pre class="hljs"><code><span class="hljs-comment">&lt;!-- markdown --&gt;</span>
{% raw %}
{{ page.title }}
{% endraw %}

<span class="hljs-comment">&lt;!-- output --&gt;</span>
{{ page.title }}
</code></pre>
<pre class="hljs"><code><span class="hljs-comment">&lt;!-- markdown --&gt;</span>
`{{ page.title }}`

<span class="hljs-comment">&lt;!-- output --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>{{ page.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
</code></pre>
<h3 id="plugins">Plugins<a class="anchor" href="#plugins"></a></h3>
<p>A plugin is a <code>Function</code>, which receives a <code>context</code> and returns a <code>context</code>. If a plugin is invoked, <code>this</code> in it may point to <code>wikic</code>. The context returned by a plugin will be passed to next plugin.</p>
<p>The <code>context</code> passed to a plugin is an <code>Object</code> which contains some of the following properties:</p>
<ul>
<li>src: string, absolute path of source</li>
<li>dist: string, absolute path of destination</li>
<li>data: string, content of document</li>
<li>site: <code>Object</code>, site config</li>
<li>page: <code>Object</code>, page config</li>
<li>renderContext: <code>Object</code>, nunjucks render context, contains <a href="#variables-in-layouts">variables</a></li>
<li>IS_DOC: boolean, whether in <code>docsPath</code></li>
</ul>
<p>Use <a href="#wikicaddpluginkey-plugin"><code>wikic.addPlugin</code></a> to add plugins or write a <code>_plugins.js</code> in root of wikic folder:</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> htmlclean = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;htmlclean&apos;</span>);

exports.beforeWritePlugins = [
  <span class="hljs-function">(<span class="hljs-params">context</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!context.data) <span class="hljs-keyword">return</span> context;
    <span class="hljs-keyword">const</span> html = htmlclean(context.data);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, context, { <span class="hljs-attr">data</span>: html });
  },
];

exports.afterReadPlugins = [
  <span class="hljs-comment">//...</span>
];
</code></pre>
<h2 id="api">API<a class="anchor" href="#api"></a></h2>
<h3 id="wikiccwd">Wikic([cwd])<a class="anchor" href="#wikiccwd"></a></h3>
<p>Creates a Wikic</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> wikic = <span class="hljs-keyword">new</span> Wikic();
</code></pre>
<p>You can pass a string to set <code>wikic.cwd</code>.</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> wikic = <span class="hljs-keyword">new</span> Wikic(<span class="hljs-string">&apos;path/to&apos;</span>);
</code></pre>
<h3 id="wikicsetupcwd">wikic.setup([cwd])<a class="anchor" href="#wikicsetupcwd"></a></h3>
<ul>
<li><code>cwd</code>: string, working dir, default value is <code>wikic.cwd || process.cwd()</code></li>
<li>Returns: <code>this</code></li>
</ul>
<p>Reloads configurations and layouts.</p>
<h3 id="wikicclean">wikic.clean()<a class="anchor" href="#wikicclean"></a></h3>
<ul>
<li>Returns a <code>Promise</code></li>
</ul>
<p>Cleans all the files in <code>publicPath</code></p>
<h3 id="wikicbuild">wikic.build()<a class="anchor" href="#wikicbuild"></a></h3>
<ul>
<li>Returns a <code>Promise</code></li>
</ul>
<p>Builds all the files in <code>docsPath</code> and <code>root</code></p>
<h3 id="wikicaddpluginkey-plugin">wikic.addPlugin(key, plugin)<a class="anchor" href="#wikicaddpluginkey-plugin"></a></h3>
<ul>
<li><code>key</code>: string, type of plugin</li>
<li><code>plugin</code>: <code>Function</code></li>
<li>Returns <code>this</code></li>
</ul>
<p>Type of plugin:</p>
<ul>
<li>&apos;afterRead&apos;: executed after reading each markdown file in order.</li>
<li>&apos;beforeWrite&apos;: invoked before writing each markdown file in order.</li>
</ul>
<p>See <a href="#plugins">Plugins</a></p>
<h3 id="wikicwatch">wikic.watch()<a class="anchor" href="#wikicwatch"></a></h3>
<ul>
<li>Returns <code>this</code></li>
</ul>
<p>Watches file change and run <code>wikic.build()</code> when changed</p>
<h3 id="wikicserve">wikic.serve()<a class="anchor" href="#wikicserve"></a></h3>
<ul>
<li>Returns a <code>Promise</code></li>
</ul>
<p>Serves the files in <code>PublicPath</code></p>
<h3 id="wikictypemapkey">wikic.typeMap(key)<a class="anchor" href="#wikictypemapkey"></a></h3>
<ul>
<li><code>key</code>: string</li>
<li>Returns typeName(a string) set in <code>wikic.config.typeMap</code></li>
</ul>
<h3 id="wikicgeturlurl">wikic.getURL(url)<a class="anchor" href="#wikicgeturlurl"></a></h3>
<ul>
<li><code>url</code>: string</li>
<li>Returns an absolute URL prefixed with base URL</li>
</ul>
<h3 id="wikicsetlisttemplateopts">wikic.setListTemplate(opts)<a class="anchor" href="#wikicsetlisttemplateopts"></a></h3>
<ul>
<li><code>opts</code>: <code>Object</code> | <code>null</code>, contains document list templates</li>
<li>Returns <code>this</code></li>
</ul>
<p>See <code>defaultOptions</code> in <a href="lib/utils/getList.js">lib/utils/getList.js</a></p>
<p>You can also setListTemplate via <code>_plugins.js</code>:</p>
<pre class="hljs"><code>exports.listTemplate = {
    headerTemplate(
    {
      level,
      index,
      typeName,
      typeSlug,
    }
  ) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`&lt;label for=&quot;<span class="hljs-subst">${level}</span>-<span class="hljs-subst">${index}</span>&quot;&gt;<span class="hljs-subst">${typeName}</span>&lt;/label&gt;
&lt;input type=&quot;checkbox&quot; id=&quot;<span class="hljs-subst">${level}</span>-<span class="hljs-subst">${index}</span>&quot; data-type=&quot;<span class="hljs-subst">${typeSlug}</span>&quot;&gt;`</span>;
  },
};
</code></pre>
<h2 id="thanks">Thanks<a class="anchor" href="#thanks"></a></h2>
<ul>
<li><a href="https://github.com/xcatliu/pagic">xcatliu/pagic</a></li>
<li><a href="https://github.com/jonschlinkert/html-toc">jonschlinkert/html-toc</a></li>
<li><a href="http://adrianmejia.com/blog/2016/08/24/Building-a-Node-js-static-file-server-files-over-HTTP-using-ES6/">Adrian Mejia Blog</a></li>
<li>...</li>
</ul>
<h2 id="license">LICENSE<a class="anchor" href="#license"></a></h2>
<p><a href="LICENSE">MIT</a></p>

        </div>
  </body>
</html>
